(function(e){function t(t){for(var s,a,o=t[0],u=t[1],l=t[2],d=0,m=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&m.push(r[a][0]),r[a]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);c&&c(t);while(m.length)m.shift()();return n.push.apply(n,l||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,o=1;o<i.length;o++){var u=i[o];0!==r[u]&&(s=!1)}s&&(n.splice(t--,1),e=a(a.s=i[0]))}return e}var s={},r={app:0},n=[];function a(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=s,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=u;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"034f":function(e,t,i){"use strict";var s=i("85ec"),r=i.n(s);r.a},"039a":function(e,t,i){"use strict";var s=i("7174"),r=i.n(s);r.a},"080e":function(e,t,i){"use strict";var s=i("8453"),r=i.n(s);r.a},"0e86":function(e,t,i){"use strict";var s=i("6b4a"),r=i.n(s);r.a},"18ec":function(e,t,i){"use strict";var s=i("efb1"),r=i.n(s);r.a},"19f0":function(e,t,i){"use strict";var s=i("59d9"),r=i.n(s);r.a},"1be2":function(e,t,i){"use strict";var s=i("faf5"),r=i.n(s);r.a},"231f":function(e,t,i){},2497:function(e,t,i){"use strict";var s=i("89f6"),r=i.n(s);r.a},2742:function(e,t,i){},"2fb0":function(e,t,i){},"304d":function(e,t,i){"use strict";var s=i("635e"),r=i.n(s);r.a},"3a7b":function(e,t,i){},4906:function(e,t,i){},"4bc9":function(e,t,i){"use strict";var s=i("3a7b"),r=i.n(s);r.a},"4f41":function(e,t,i){},5116:function(e,t,i){e.exports=i.p+"img/leaderboard-crown.d1fd4998.svg"},"51ed":function(e,t,i){"use strict";var s=i("2fb0"),r=i.n(s);r.a},"56c9":function(e,t,i){"use strict";var s=i("2742"),r=i.n(s);r.a},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var s=i("a026"),r=i("8aa5"),n=i.n(r),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"content"},[e.betaMode?s("div",{staticClass:"corner-ribbon bottom-right sticky blue"},[e._v(" Beta ")]):e._e(),s("b-navbar",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{toggleable:"md",type:"dark",variant:e.navbarVariant}},[s("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),s("b-navbar-brand",{attrs:{to:"/",id:"brandName"}},[e._v(e._s(e.brandName))]),s("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[s("b-navbar-nav",{attrs:{id:"navLinks"}},[s("b-nav-item",{attrs:{to:{name:"Home",query:e.routerQuery},exact:""}},[e._v("Home")]),s("b-nav-item",{attrs:{to:{name:"Leaderboard",query:e.routerQuery}}},[e._v("Leaderboard")]),s("b-nav-item",{attrs:{to:{name:"Play",query:e.routerQuery}}},[e._v("Play")]),s("b-nav-item",{attrs:{to:{name:"Chats",query:e.routerQuery}}},[e._v("Chats")]),e.needsTutorial?s("b-nav-item",{attrs:{to:{name:"Tutorial",query:e.routerQuery}}},[e._v("Tutorial")]):e._e(),e.userData.admin?s("b-nav-item",{attrs:{to:{name:"Admin",query:e.routerQuery}}},[e._v("Admin")]):e._e()],1),s("b-navbar-nav",{staticClass:"ml-auto"},[e.userIsDefined?s("b-nav-item-dropdown",{attrs:{right:""}},[s("template",{slot:"button-content"},[s("em",[e._v(e._s(e.userInfo.displayName))])]),s("b-dropdown-item",{attrs:{to:{name:"Profile",query:e.routerQuery}}},[e._v("Profile")]),s("b-dropdown-item",{on:{click:e.logout}},[e._v("Signout")])],2):s("b-nav-item",{attrs:{to:{name:"Login",query:e.routerQuery}}},[e._v("Login")]),e.userIsDefined?s("b-nav-text",[e.currentLevel.img?s("b-img",{staticClass:"m-1",attrs:{rounded:"circle",width:"20",height:"20",alt:"img",src:e.currentLevel.img}}):e._e(),e._v(" "+e._s(e.userData.score)+" ")],1):e._e()],1)],1)],1),s("nav",[s("ul",{staticClass:"navRoot"},[s("li",{staticClass:"navSection main-logo"},[s("router-link",{attrs:{to:"/"}},[s("img",{attrs:{src:i("b81c"),alt:"Swipes for Science logo"}})])],1),s("li",{staticClass:"navSection mobile-menu"},[s("SliderMenu",{attrs:{needsTutorial:!1,isAdmin:!1}})],1),s("li",{staticClass:"navSection account-details"},[s("AccountMenu",{attrs:{userInfo:e.userInfo,loggedIn:e.userIsDefined},on:{logout:e.logout}})],1),s("li",{staticClass:"navSection desktop-menu"})])]),e.isMounted?s("div",{staticClass:"router"},[s("router-view",{attrs:{userInfo:e.userInfo,userData:e.userData,allUsers:e.allUsers,levels:e.levels,currentLevel:e.currentLevel,config:e.config,db:e.db,routerQuery:e.routerQuery},on:{taken_tutorial:e.setTutorial}})],1):e._e(),e.showConfig?s("Configure",{ref:"configurationPane",attrs:{config:e.config,userInfo:e.userInfo,db:e.db,configurationState:e.configurationState},on:{closeConfig:e.closeConfig}}):e._e()],1),s("Footer",{attrs:{config:e.config,routerQuery:e.routerQuery},on:{openConfig:e.openConfig}})],1)},o=[],u=(i("d81d"),i("b64b"),i("ac1f"),i("5319"),i("5f5b")),l=i("bc3a"),c=i.n(l),d=i("5f30"),m=i.n(d),p=i("2ef0"),f=i.n(p),h=(i("f9e3"),i("2dd8"),i("1f54"),i("fa6d"),i("6924"),i("f8e9"),i("9f9f"),i("7dc5")),g=h,v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"configuration"},[i("div",{style:e.styleContent},[i("h3",[e._v(" Swipes for Science "),i("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close",id:"closeConfigButton"},on:{click:e.close}},[i("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])])]),i("p",{staticClass:"lead"},[e._v("Configuration")]),0===e.step?i("FirebaseKeys",{on:{newFirebaseKeys:e.setNewFirebaseKeys}}):e._e(),1===e.step&&0===Object.keys(e.userInfo).length?i("div",[i("b-alert",{attrs:{show:""}},[e._v(" Thanks for your keys! Follow the steps on the video above: ")]),i("video",{staticClass:"video",attrs:{src:"https://s3.amazonaws.com/hotdognothotdog/setupAuthAndDatabase.webm",controls:""}}),i("b-alert",{attrs:{show:""}},[e._v(" when you're done, "),i("router-link",{attrs:{to:"/login"}},[e._v("log in")]),e._v(" or "),i("router-link",{attrs:{to:"/signup"}},[e._v("sign up")]),e._v(" to continue with configuration. ")],1)],1):e._e(),1===e.step&&Object.keys(e.userInfo).length?i("div",[null!==e.userInfo.displayName?i("Initializer",{attrs:{config:e.config,userInfo:e.userInfo,db:e.db},on:{next:e.next}}):i("div",[e._v("Hold on... "+e._s(e.userInfo.displayName))])],1):e._e(),2===e.step?i("App",{attrs:{config:e.config}}):e._e(),3===e.step?i("Widget",{attrs:{config:e.config}}):e._e(),4===e.step?i("Home",{attrs:{config:e.config}}):e._e(),5===e.step?i("Tutorial",{attrs:{config:e.config}}):e._e(),6===e.step?i("div",[i("h5",[e._v("Lock down your database!")]),i("p",[e._v(" Copy/paste your rules into your firebase console in the 'rules' tab. ")]),i("textarea",{staticClass:"codeBlock",attrs:{disabled:"",rows:"15"},domProps:{value:e.rules}}),i("br"),i("b-button",{attrs:{variant:"primary"}},[e._v("Copy to clipboard")])],1):e._e(),7===e.step?i("div",[i("p",[e._v("1. Download your config file.")]),i("b-button",{staticClass:"mb-3",attrs:{variant:"primary"},on:{click:e.downloadConfig}},[e._v("Download")]),i("p",[e._v("2. Upload your config file to the web (e.g S3, GitHub, Gist, etc)")]),i("p",[e._v("3. Copy/paste the public URL to your config here:")]),i("b-input",{model:{value:e.configURL,callback:function(t){e.configURL=t},expression:"configURL"}})],1):e._e(),8===e.step?i("div",[i("h5",[e._v("Done!")]),i("p",{staticClass:"lead"},[e._v(" The URL to your project is: ")]),i("p",[i("a",{attrs:{href:"https://dev.swipesforscience.org/#/?config="+e.configURL}},[e._v(" https://dev.swipesforscience.org/#/?config="+e._s(e.configURL)+" ")])])]):e._e(),e.step>=2?i("div",{staticClass:"mt-3 pt-3"},[e.step>=3?i("b-button",{attrs:{variant:"secondary"},on:{click:e.prev}},[e._v(" Prev ")]):e._e(),e.step<=7?i("b-button",{attrs:{variant:"secondary",disabled:7===e.step&&!e.configURL},on:{click:e.next}},[e._v(" Next ")]):e._e()],1):e._e()],1),i("div",{style:e.styleResize,attrs:{id:"expander"},on:{mousedown:e.startResize}})])},b=[],y=(i("99af"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",[e._v("Setting up your database")]),e._m(0),i("video",{staticClass:"video",attrs:{src:"https://s3.amazonaws.com/hotdognothotdog/createFirebaseProject.webm",controls:""}}),i("label",{attrs:{for:"firebase"}},[e._v("Firebase Keys:")]),i("b-textarea",{attrs:{placeholder:"Copy/paste your firebase API keys from the firebase console in here",rows:5},model:{value:e.fkeys,callback:function(t){e.fkeys=t},expression:"fkeys"}}),i("b-button",{staticClass:"mt-2 mb-2",attrs:{variant:"secondary",disabled:!e.fkeys},on:{click:e.parseFirebaseKeys}},[e._v("Apply")])],1)}),w=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ol",{staticClass:"text-left ml-3 pl-3"},[i("li",[e._v(" Create a new Firebase project at "),i("a",{attrs:{href:"https://console.firebase.google.com"}},[e._v("console.firebase.google.com")])]),i("li",[e._v(' Copy the API keys to the text box below and hit "Apply" ')])])}],S=(i("1276"),{data:function(){return{fkeys:null}},methods:{parseFirebaseKeys:function(){var e=this,t=["apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId"],i={};return f.a.map(t,(function(t){i[t]=e.fkeys.split("".concat(t,': "'))[1].split('"')[0]})),this.$emit("newFirebaseKeys",i),i}}}),_=S,C=(i("9bad"),i("2877")),k=Object(C["a"])(_,y,w,!1,null,"7f451c7e",null),x=k.exports,T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",[e._v("App")]),i("label",{attrs:{for:"manifestUrl"}},[e._v("manifestUrl")]),i("b-form-input",{attrs:{type:"text",id:"manifestUrl"},model:{value:e.config.manifestUrl,callback:function(t){e.$set(e.config,"manifestUrl",t)},expression:"config.manifestUrl"}})],1)},I=[],j={props:{config:{type:Object,required:!0}},data:function(){return{}},methods:{},mounted:function(){this.$router&&this.$router.replace("/admin")}},P=j,O=Object(C["a"])(P,T,I,!1,null,null,null),L=O.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",{staticClass:"mt3 pt-3"},[e._v("Home")]),i("label",{attrs:{for:"navbarVariant"}},[e._v("Navbar variant:")]),i("b-form-select",{staticClass:"mb-3",attrs:{id:"navbarVariant",options:e.navbarOptions},model:{value:e.config.app.navbarVariant,callback:function(t){e.$set(e.config.app,"navbarVariant",t)},expression:"config.app.navbarVariant"}}),i("label",{attrs:{for:"title"}},[e._v("Title")]),i("b-form-input",{attrs:{type:"text",id:"title",placeholder:"your title here"},model:{value:e.config.home.title,callback:function(t){e.$set(e.config.home,"title",t)},expression:"config.home.title"}}),i("label",{staticClass:"mt-2",attrs:{for:"tagline"}},[e._v("Tagline")]),i("b-form-input",{attrs:{type:"text",id:"tagline",placeholder:"your tagline here"},model:{value:e.config.home.tagline,callback:function(t){e.$set(e.config.home,"tagline",t)},expression:"config.home.tagline"}}),i("label",{staticClass:"mt-2",attrs:{for:"backgroundUrl"}},[e._v("Background URL")]),i("b-form-input",{attrs:{type:"text",id:"backgroundUrl",placeholder:"url to a picture"},model:{value:e.config.home.backgroundUrl,callback:function(t){e.$set(e.config.home,"backgroundUrl",t)},expression:"config.home.backgroundUrl"}})],1)},q=[],$={props:{config:{type:Object,required:!0}},data:function(){return{navbarOptions:["primary","secondary","info","warning","danger"]}},mounted:function(){this.$router&&this.$router.replace("/")}},U=$,A=Object(C["a"])(U,E,q,!1,null,null,null),F=A.exports,M=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",{staticClass:"mt3 pt-3"},[e._v("Tutorial")]),i("div",{staticClass:"form-check"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.config.needsTutorial,expression:"config.needsTutorial"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"defaultCheck1"},domProps:{checked:Array.isArray(e.config.needsTutorial)?e._i(e.config.needsTutorial,null)>-1:e.config.needsTutorial},on:{change:function(t){var i=e.config.needsTutorial,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,a=e._i(i,n);s.checked?a<0&&e.$set(e.config,"needsTutorial",i.concat([n])):a>-1&&e.$set(e.config,"needsTutorial",i.slice(0,a).concat(i.slice(a+1)))}else e.$set(e.config,"needsTutorial",r)}}}),i("label",{staticClass:"form-check-label",attrs:{for:"defaultCheck1"}},[e._v(" Needs a tutorial? ")])])])},N=[],D={props:{config:{type:Object,required:!0}}},z=D,R=Object(C["a"])(z,M,N,!1,null,null,null),V=R.exports,H=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",{staticClass:"mt3 pt-3"},[e._v("Widget")]),i("b-form-select",{staticClass:"mb-3",attrs:{id:"navbarVariant",options:e.widgetOptions},model:{value:e.config.widgetType,callback:function(t){e.$set(e.config,"widgetType",t)},expression:"config.widgetType"}}),i("h5",{staticClass:"mt3 pt-3"},[e._v("Widget Properties")]),e._l(e.widgetSchema,(function(t,s){return i("div",{key:s,staticClass:"mt-2"},[i("label",{attrs:{for:s}},[e._v(e._s(s))]),""===t.type()?i("div",[i("b-form-input",{attrs:{type:"text",id:s,placeholder:t.default},model:{value:e.config.widgetProperties[s],callback:function(t){e.$set(e.config.widgetProperties,s,t)},expression:"config.widgetProperties[key]"}})],1):Array.isArray(t.type())?i("div",[i("b-alert",{attrs:{show:"",variant:e.danger}},[e._v("Not implemented yet!")])],1):e._e()])}))],2)},B=[],W=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imageSwipe"},[i("transition",{key:e.swipe,attrs:{name:e.swipe}},[i("div",{key:e.baseUrl,staticClass:"user-card"},[i("div",{staticClass:"image_area"},[i("progressive-img",{directives:[{name:"hammer",rawName:"v-hammer:swipe.horizontal",value:e.onSwipe,expression:"onSwipe",arg:"swipe",modifiers:{horizontal:!0}}],staticClass:"user-card__picture mx-auto",attrs:{src:e.baseUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1}})],1),i("div",{staticClass:"user-card__name"},[e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowleft"],expression:"['arrowleft']"},{name:"hammer",rawName:"v-hammer:swipe.left",value:e.swipeLeft,expression:"swipeLeft",arg:"swipe",modifiers:{left:!0}}],ref:"leftSwipe",staticStyle:{float:"left"},attrs:{variant:"danger"},on:{click:e.swipeLeft,shortkey:e.swipeLeft}},[i("i",{staticClass:"fa fa-long-arrow-left",attrs:{"aria-hidden":"true"}}),e._v(" "+e._s(e.widgetProperties.leftSwipeLabel)+" ")]):i("span",{staticStyle:{float:"left"}},[e.widgetSummary?i("span",[e._v(" ave vote: "+e._s(e.widgetSummary.aveVote||0)+" ")]):i("span",[e._v("ave vote: N/A")])]),e.playMode?i("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.widgetPointer}},[e._v("Help")]):e._e(),e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowright"],expression:"['arrowright']"}],ref:"rightSwipe",staticStyle:{float:"right"},attrs:{variant:"success"},on:{click:e.swipeRight,shortkey:e.swipeRight}},[e._v(" "+e._s(e.widgetProperties.rightSwipeLabel)+" "),i("i",{staticClass:"fa fa-long-arrow-right",attrs:{"aria-hidden":"true"}})]):i("span",{staticStyle:{float:"right"}},[e.widgetSummary?i("span",[e._v(" num votes: "+e._s(e.widgetSummary.count||0)+" ")]):i("span",[e._v("num votes: 0")])])],1)])])],1)},Q=[],G=(i("a9e3"),i("6591")),K=i("8ff0"),Y=i.n(K),J=i("8a5d"),X=i("9076"),Z=i.n(X);s["default"].use(Z.a),s["default"].use(G["VueHammer"]),s["default"].use(i("3717"),{prevent:[".modal-content",".modal-dialog"]});var ee={name:"ImageSwipe",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},components:{VueHammer:G["VueHammer"],GridLoader:J["a"]},directives:{imagesLoaded:Y.a},data:function(){return{status:"loading",swipe:null}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null}},mounted:function(){var e=this;this.$nextTick((function(){"tutorial"===e.playMode&&e.showTutorialStep(e.tutorialStep)}))},methods:{showTutorialStep:function(e){switch(e){case 0:this.$refs.rightSwipe.classList.add("focus");break;case 1:this.$refs.leftSwipe.classList.add("focus");break;case 2:this.$refs.helpButton.classList.add("focus");break;default:break}},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return f.a.map(s,(function(e,t){i=i.replace("{".concat(t,"}"),e)})),i},getScore:function(e){var t=this.getFeedback(e);return"danger"===t.variant?0:1},getFeedback:function(e){var t;if(t=this.widgetSummary?this.widgetSummary:{count:0},t.count>4){var i=t.aveVote;return i>=.7&&!e?{show:!1,variant:"danger",message:"+0 most people swiped right"}:i<=.3&&e?{show:!1,variant:"danger",message:"+0 most people swiped left"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return t/=this.widgetSummary.count+1,{aveVote:t,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to the image file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill in the template"},leftSwipeLabel:{type:String,required:!1,default:"Fail",description:"label for the left swipe button"},rightSwipeLabel:{type:String,required:!1,default:"True",description:"label for the right swipe button"}}},swipeLeft:function(){this.setSwipe("swipe-left"),this.vote(0)},swipeRight:function(){this.setSwipe("swipe-right"),this.vote(1)},onSwipe:function(e){2===e.direction?this.swipeLeft():this.swipeRight()},setSwipe:function(e){this.swipe=e},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),"play"===this.playMode&&(this.showTutorialStep(0),this.showTutorialStep(1),this.showTutorialStep(2)),this.swipeLeft(),this.swipeRight(),this.onSwipe({direction:1}),this.onSwipe({direction:2}),this.setSwipe("swipe-left"),this.getPropertiesSchema(),1}}},te=ee,ie=(i("f9fb"),Object(C["a"])(te,W,Q,!1,null,"6aa28c2a",null)),se=ie.exports,re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.showStimuli?i("div",{staticClass:"imageSwipe"},[i("transition",{key:e.swipe,attrs:{name:e.swipe}},[i("div",{key:e.baseUrl,staticClass:"user-card"},[i("div",{staticClass:"image_area"},[i("progressive-img",{directives:[{name:"hammer",rawName:"v-hammer:swipe.horizontal",value:e.onSwipe,expression:"onSwipe",arg:"swipe",modifiers:{horizontal:!0}}],class:["user-card__picture","mx-auto",e.widgetProperties.timing.stimulusFadeIn?"":"no-fade-in"],attrs:{src:e.baseUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1},on:{onLoad:e.onImgLoad}})],1),i("div",{staticClass:"user-card__name"},[e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowleft"],expression:"['arrowleft']"},{name:"hammer",rawName:"v-hammer:swipe.left",value:e.swipeLeft,expression:"swipeLeft",arg:"swipe",modifiers:{left:!0}}],ref:"leftSwipe",staticStyle:{float:"left"},attrs:{variant:"danger"},on:{click:e.swipeLeft,shortkey:e.swipeLeft}},[i("i",{staticClass:"fa fa-long-arrow-left",attrs:{"aria-hidden":"true"}}),e._v(" "+e._s(e.widgetProperties.leftSwipe.label)+" ")]):i("span",{staticStyle:{float:"left"}},[e.widgetSummary?i("span",[e._v(" ave vote: "+e._s(e.widgetSummary.aveVote||0)+" ")]):i("span",[e._v("ave vote: N/A")])]),e.playMode?i("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.widgetPointer}},[e._v("Help")]):e._e(),e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowright"],expression:"['arrowright']"}],ref:"rightSwipe",staticStyle:{float:"right"},attrs:{variant:"success"},on:{click:e.swipeRight,shortkey:e.swipeRight}},[e._v(" "+e._s(e.widgetProperties.rightSwipe.label)+" "),i("i",{staticClass:"fa fa-long-arrow-right",attrs:{"aria-hidden":"true"}})]):i("span",{staticStyle:{float:"right"}},[e.widgetSummary?i("span",[e._v(" num votes: "+e._s(e.widgetSummary.count||0)+" ")]):i("span",[e._v("num votes: 0")])])],1)])])],1):e._e()},ne=[];s["default"].use(Z.a),s["default"].use(G["VueHammer"]),s["default"].use(i("3717"));var ae={name:"TimedImageSwipe",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},components:{VueHammer:G["VueHammer"],GridLoader:J["a"]},directives:{imagesLoaded:Y.a},data:function(){return{status:"loading",swipe:null,durationTimer:null,interStimuliTimer:null,showStimuli:!0}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null},timing:function(){return"tutorial"===this.playMode?{}:this.widgetProperties.timing}},watch:{widgetPointer:function(){this.preImgLoad()}},mounted:function(){var e=this;this.$nextTick((function(){"tutorial"===e.playMode&&e.showTutorialStep(e.tutorialStep)}))},beforeUnmount:function(){clearTimeout(this.durationTimer),clearTimeout(this.interStimuliTimer)},methods:{showTutorialStep:function(e){switch(e){case 0:this.$refs.rightSwipe.classList.add("focus");break;case 1:this.$refs.leftSwipe.classList.add("focus");break;case 2:this.$refs.helpButton.classList.add("focus");break;default:break}},preImgLoad:function(){var e=this,t=this.timing.interStimuliDuration;t&&(this.showStimuli=!1,this.interStimuliTimer=setTimeout((function(){e.showStimuli=!0,clearTimeout(e.interStimuliTimer)}),t))},onImgLoad:function(){var e=this;this.$emit("setStartTime",new Date),this.timing.stimulusDuration&&(this.durationTimer=setTimeout((function(){e.vote(e.timing.timeoutValue)}),this.timing.stimulusDuration))},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return f.a.map(s,(function(e,t){i=i.replace("{".concat(t,"}"),e)})),i},getScore:function(e){var t=this.getFeedback(e);return"danger"===t.variant?0:1},getFeedback:function(e){var t;if(t=this.widgetSummary?this.widgetSummary:{count:0},t.count>4){var i=t.aveVote;return i>=.7&&!e?{show:!1,variant:"danger",message:"+0 most people swiped right"}:i<=.3&&e?{show:!1,variant:"danger",message:"+0 most people swiped left"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return t/=this.widgetSummary.count+1,{aveVote:t,count:this.widgetSummary.count+1}},vote:function(e){"tutorial"===this.playMode?this.tutorialVote(e):(this.$emit("widgetRating",e),clearTimeout(this.durationTimer),clearTimeout(this.interStimuliTimer))},tutorialVote:function(e){this.$emit("widgetRating",{pointer:this.widgetPointer,value:e})},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to the image file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill in the template"},leftSwipe:{type:Object,schema:{label:{type:String,required:!1,default:"Fail",description:"label for the left swipe button"},value:{type:Number,required:!1,default:-1,description:"value stored to database"}}},rightSwipe:{type:Object,schema:{label:{type:String,required:!1,default:"Pass",description:"label for the right swipe button"},value:{type:Number,required:!1,default:1,description:"value stored to database"}}},timing:{type:Object,schema:{stimulusDuration:{type:Number,required:!1,default:null,description:"stimulus duration (defaults to infinite)"},timeoutValue:{type:Number,required:!1,default:0,description:"value stored to database when stimulus times out before user has swiped"},interStimuliDuration:{type:Number,required:!1,default:0,description:"time between stimuli end and next stimuli load (defaults to zero). Note: this is only as precise as the clients environment allows"},stimulusFadeIn:{type:Boolean,required:!1,default:!0,description:"sets the fade-in effect on stimulus load; set to `false` for precise timing (default: true)"}}}}},swipeLeft:function(){this.setSwipe("swipe-left"),this.vote(this.widgetProperties.leftSwipe.value)},swipeRight:function(){this.setSwipe("swipe-right"),this.vote(this.widgetProperties.rightSwipe.value)},onSwipe:function(e){2===e.direction?this.swipeLeft():this.swipeRight()},setSwipe:function(e){this.swipe=e},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),"play"===this.playMode&&(this.showTutorialStep(0),this.showTutorialStep(1),this.showTutorialStep(2)),this.swipeLeft(),this.swipeRight(),this.onSwipe({direction:1}),this.onSwipe({direction:2}),this.setSwipe("swipe-left"),this.getPropertiesSchema(),1}}},oe=ae,ue=(i("6816"),Object(C["a"])(oe,re,ne,!1,null,"06ada62c",null)),le=ue.exports,ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate"},[i("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetPointer))]),e.playMode?e._e():i("p",{staticClass:"mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))]),e.playMode?i("div",{staticClass:"row"},[i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"danger"},on:{click:function(t){return e.vote(0)}}},[e._v("Vote No")]),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"info",to:"/review/"+e.widgetPointer}},[e._v("Help")]),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"success"},on:{click:function(t){return e.vote(1)}}},[e._v("Vote Yes")])],1):e._e()])},de=[],me={name:"TemplateWidget",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{}},methods:{getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return t/=this.widgetSummary.count+1,{aveVote:t,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},pe=me,fe=Object(C["a"])(pe,ce,de,!1,null,null,null),he=fe.exports,ge={props:{config:{type:Object,required:!0}},data:function(){return{widgetOptions:["ImageSwipe","TimedImageSwipe"]}},computed:{widgetSchema:function(){var e=this.getWidgetSchema(this.config.widgetType);return e}},methods:{getWidgetSchema:function(e){var t;switch(e){case"ImageSwipe":t=s["default"].extend(se);break;case"TimedImageSwipe":t=s["default"].extend(le);break;default:t=s["default"].extend(he);break}var i=new t({propsData:{widgetPointer:"",widgetProperties:{},userSettings:{}}});return i.getPropertiesSchema()}},mounted:function(){this.$router&&this.$router.replace("/play")}},ve=ge,be=Object(C["a"])(ve,H,B,!1,null,null,null),ye=be.exports,we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"text-left ml-3 pl-3"},[i("p",[e._v("Admin: "+e._s(e.admin))]),i("p",[e._v("sampleCounts: "+e._s(e.sampleCounts))]),i("p",[e._v("sampleSummary: "+e._s(e.sampleSummary))]),i("p",[e._v("chats: "+e._s(e.chats))]),i("p",[e._v("user seen samples: "+e._s(e.userSeenSamples))]),i("p",[e._v("votes: "+e._s(e.votes))])]),e.ready?i("b-btn",{on:{click:function(t){return e.next()}}},[e._v("Next")]):e._e()],1)},Se=[],_e={name:"Initializer",props:{config:{type:Object,required:!0},db:{type:Object,required:!0},userInfo:{type:Object,required:!0}},data:function(){return{admin:!1,sampleCounts:!1,sampleSummary:!1,chats:!1,userSeenSamples:!1,userSettings:!1,votes:!1}},computed:{uid:function(){return this.userInfo.uid},ready:function(){return this.admin&&this.sampleCounts&&this.sampleSummary&&this.chats&&this.userSeenSamples&&this.votes&&this.userSettings}},watch:{ready:function(){this.ready&&this.next()}},mounted:function(){this.initAll()},methods:{initAdmin:function(){var e=this,t=this.userInfo.displayName;this.db.ref("settings").child("admins").child(t).set(1),this.db.ref("users").child(t).child("admin").set(!0).then((function(){e.admin=!0}))},initSampleCounts:function(){var e=this;this.db.ref("sampleCounts").once("value").then((function(t){var i=t.val();null===i&&e.db.ref("sampleCounts").set(0)})).then((function(){e.sampleCounts=!0}))},initSampleSummary:function(){var e=this;this.db.ref("sampleSummary").once("value").then((function(t){var i=t.val();null===i&&e.db.ref("sampleSummary").set(0)})).then((function(){e.sampleSummary=!0}))},initChats:function(){var e=this;this.db.ref("chats").once("value").then((function(t){var i=t.val();null===i&&e.db.ref("chats").set(0)})).then((function(){e.chats=!0}))},initUserSeenSamples:function(){var e=this,t=this.userInfo.displayName;this.db.ref("userSeenSamples").child(t).once("value").then((function(i){var s=i.val();null===s&&e.db.ref("userSeenSamples").child(t).set(0)})).then((function(){e.userSeenSamples=!0}))},initVotes:function(){var e=this;this.db.ref("votes").once("value").then((function(t){var i=t.val();null===i&&e.db.ref("votes").set(0)})).then((function(){e.votes=!0}))},initUserSettings:function(){var e=this;this.db.ref("userSettings").once("value").then((function(t){var i=t.val();null===i&&e.db.ref("userSettings").set(0)})).then((function(){e.userSettings=!0}))},initAll:function(){this.initAdmin(),this.initSampleCounts(),this.initSampleSummary(),this.initChats(),this.initUserSeenSamples(),this.initUserSettings(),this.initVotes()},next:function(){this.$emit("next")}}},Ce=_e,ke=Object(C["a"])(Ce,we,Se,!1,null,null,null),xe=ke.exports;function Te(e,t){var i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(t))),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}var Ie,je={name:"configuration",props:{config:{type:Object,required:!0},userInfo:{type:Object,required:!0},db:{type:Object,required:!0},configurationState:{type:Object,required:!0}},data:function(){return{fkeys:null,width:300,resizing:!1,configURL:""}},components:{FirebaseKeys:x,App:L,Home:F,Tutorial:V,Widget:ye,Initializer:xe},computed:{styleContent:function(){return{width:"".concat(this.width,"px"),position:"fixed",top:0,"z-index":"9",background:"#ffffffe0",height:"100%",padding:"10px","overflow-y":"scroll"}},styleResize:function(){return{left:"".concat(this.width,"px")}},step:function(){return this.configurationState.step},rules:function(){return'\n      {\n        "rules": {\n          ".read": "auth.uid === \''.concat(this.userInfo.uid,'\'", // replace w/ your UID\n          ".write": "auth.uid === \'').concat(this.userInfo.uid,'\'",// replace w/ your UID\n          "users": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n            "$displayName": {\n              ".read": true,\n              ".write": "$displayName === auth.token.name",\n              "admin": {\n                ".write": "auth.uid === \'').concat(this.userInfo.uid,'\'", // replace w/ your UID\n              }\n            }\n          },\n          "userSettings": {\n            ".read": false,\n            ".write": "auth !== null && data.exists()",\n            "$displayName": {\n              ".read": "$displayName === auth.token.name",\n              ".write": "$displayName === auth.token.name",\n            },\n          },\n          "chats": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n          },\n          "sampleCounts": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n          },\n          "sampleSummary": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n          },\n          "settings": {\n            ".read": true,\n            ".write": "auth.uid === \'').concat(this.userInfo.uid,'\'" // replace w/ your UID\n          },\n          "userSeenSamples": {\n            ".read": true,\n            "$displayName": {\n              ".write": true, // "$displayName === auth.token.name"\n            },\n          },\n          "votes": {\n            ".write": "data.exists()",\n            ".read": "auth !== null",\n          }\n        }\n      }\n      ')}},methods:{update:function(){},startResize:function(){this.resizing=!0},resize:function(e){this.resizing&&(this.width=e.clientX)},endResize:function(){this.resizing=!1},close:function(){this.$emit("closeConfig")},setNewFirebaseKeys:function(e){this.config.firebaseKeys=e,this.configurationState.step=1},next:function(){this.configurationState.step+=1},prev:function(){this.configurationState.step-=1},downloadConfig:function(){Te("config.json",JSON.stringify(this.config,null,2))}},watch:{userInfo:{handler:function(){this.userInfo.displayName&&this.$forceUpdate()},deep:!0}},mounted:function(){window.addEventListener("mousemove",this.resize),window.addEventListener("mouseup",this.endResize),this.config.needsTutorial=!1},beforeDestroy:function(){window.removeEventListener("mousemove",this.resize),window.removeEventListener("mouseup",this.endResize)}},Pe=je,Oe=(i("0e86"),Object(C["a"])(Pe,v,b,!1,null,"81decd62",null)),Le=Oe.exports,Ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"slider-menu"},[i("a",{ref:"slider-menu-toggle",staticClass:"slider-menu__toggle",on:{click:function(t){return e.toggleMenu()}}},[i("svg",{staticStyle:{"fill-rule":"evenodd","clip-rule":"evenodd","stroke-linecap":"round"},attrs:{width:"31px",height:"22px",viewBox:"0 0 31 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xml:space":"preserve","xmlns:serif":"http://www.serif.com/"}},[i("g",{attrs:{transform:"matrix(1,0,0,1,-26.8461,-27.8461)"}},[i("path",{staticStyle:{fill:"none",stroke:"rgb(88,65,171)","stroke-width":"2.5px"},attrs:{d:"M52,33L32,33M47,44L32,44"}})])])]),e.isActive?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:{exclude:["slider-menu-toggle"],handler:"onClose"},expression:"{ exclude: ['slider-menu-toggle'], handler: 'onClose' }"}],staticClass:"slider-menu__drawer"},[i("ul",e._l(e.menuItems,(function(t){return i("li",{key:t.name},[i("router-link",{attrs:{to:t.path}},[e._v(e._s(t.name))])],1)})),0)]):e._e()])},qe=[],$e=(i("4160"),i("159b"),{bind:function(e,t,i){Ie=function(s){s.stopPropagation();var r=t.value,n=r.handler,a=r.exclude,o=!1;a.forEach((function(e){if(!o){var t=i.context.$refs[e];o=t.contains(s.target)}})),e.contains(s.target)||o||i.context[n]()},document.addEventListener("click",Ie),document.addEventListener("touchstart",Ie)},unbind:function(){document.removeEventListener("click",Ie),document.removeEventListener("touchstart",Ie)}}),Ue=$e,Ae={name:"SliderMenu",data:function(){return{isActive:!1,menuItems:[{path:"/",name:"Home"},{path:"/leaderboard",name:"Leaderboard"},{path:"/chats",name:"Chats"},{path:"/play",name:"Play"},{path:"/admin",name:"Admin"},{path:"/tutorial",name:"Tutorial"}]}},props:{needsTutorial:{type:Boolean,required:!0},isAdmin:{type:Boolean,required:!0}},methods:{onClose:function(){this.isActive=!1},toggleMenu:function(){this.isActive=!this.isActive}},directives:{ClickOutside:Ue},watch:{$route:function(){this.isActive=!1}}},Fe=Ae,Me=(i("4bc9"),Object(C["a"])(Fe,Ee,qe,!1,null,null,null)),Ne=Me.exports,De=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"account-menu"},[e.loggedIn?s("div",{ref:"account-menu-toggle",on:{click:e.toggleMenu}},[s("img",{staticClass:"avatar",attrs:{src:i("95a6"),alt:"Profile Avatar"}}),s("div",{staticClass:"account-menu__user-information"},[s("span",{staticClass:"username"},[e._v(e._s(e.userInfo.displayName))]),s("span",{staticClass:"user-score"},[e._v("99999 points")])])]):s("ul",[s("li",[s("router-link",{staticClass:"nav__link",attrs:{to:"/login"}},[s("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),e._v(" Login ")])],1)]),e.isActive?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:{exclude:["account-menu-toggle"],handler:"onClose"},expression:"{ exclude: ['account-menu-toggle'], handler: 'onClose' }"}],staticClass:"account-menu__dropdown"},[s("ul",[s("li",[e._v("Profile")]),s("li",[s("span",{on:{click:e.onClickLogout}},[e._v("Sign out")])])])]):e._e()])},ze=[],Re={name:"AccountMenu",data:function(){return{isActive:!1}},props:{loggedIn:{type:Boolean,required:!0},userInfo:{type:Object,required:!0}},methods:{onClose:function(){this.isActive=!1},toggleMenu:function(){this.isActive=!this.isActive},onClickLogout:function(){this.$emit("logout")}},directives:{ClickOutside:Ue},watch:{$route:function(){this.isActive=!1}}},Ve=Re,He=(i("2497"),Object(C["a"])(Ve,De,ze,!1,null,null,null)),Be=He.exports,We=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("footer",[s("div",{staticClass:"footer__container"},[s("img",{staticClass:"logo",attrs:{src:i("7968"),alt:"eLife logo"}}),s("nav",e._l(e.menuItems,(function(t){return s("router-link",{key:t.name,staticClass:"nav__link",attrs:{to:t.path}},[e._v(e._s(t.name))])})),1),s("div",{staticClass:"configureButton"},[s("b-button",{attrs:{variant:"info"},on:{click:e.openConfig}},[s("i",{staticClass:"fa fa-wrench",attrs:{"aria-hidden":"true"}}),e._v(" Configure ")])],1)])])},Qe=[],Ge={name:"Footer",props:{config:{type:Object,required:!0},routerQuery:{type:Object,required:!0}},data:function(){return{menuItems:[{path:"/",name:"Home"},{path:"/play",name:"Game"},{path:"/chats",name:"Chat"},{path:"/leaderboard",name:"Leaderboard"},{path:"/about",name:"About"},{path:"/contact",name:"Contact us"}]}},methods:{openConfig:function(e){e.preventDefault(),this.$emit("openConfig")}}},Ke=Ge,Ye=(i("51ed"),Object(C["a"])(Ke,We,Qe,!1,null,"300691de",null)),Je=Ye.exports;s["default"].use(m.a),s["default"].use(u["a"]),window.firebase=n.a;var Xe={name:"app",data:function(){return{userInfo:{},db:n.a.database(),config:g,showConfig:!1,allUsers:[],configurationState:{step:0},showHeader:!1,isMounted:!1}},mounted:function(){this.userInfo=n.a.auth().currentUser;var e=this;n.a.auth().onAuthStateChanged((function(t){e.userInfo=t||{}})),this.isMounted=!0},components:{Configure:Le,Footer:Je,SliderMenu:Ne,AccountMenu:Be},firebase:function(){return{allUsers:{source:this.db.ref("/users/").orderByChild("score"),asObject:!0}}},watch:{firebaseKeys:function(e){var t=this;n.a.auth().signOut().then((function(){t.userInfo={},n.a.app().delete().then((function(){n.a.initializeApp(e),t.db=n.a.database(),t.db.ref("/users/").orderByChild("score").on("value",(function(e){t.allUsers=e.val()})),t.userInfo=n.a.auth().currentUser||{};var i=t;n.a.auth().onAuthStateChanged((function(e){i.userInfo=e||{}}))}))}))}},computed:{firebaseKeys:function(){return this.config.firebaseKeys},brandName:function(){return this.config.home.title},betaMode:function(){return this.config.betaMode},needsTutorial:function(){return this.config.needsTutorial},navbarVariant:function(){return this.config.app&&this.config.app.navbarVariant||"info"},userData:function(){var e=this,t={};return null==this.userInfo?t:Object.keys(this.userInfo).length?(f.a.map(this.allUsers,(function(i,s){s===e.userInfo.displayName&&(t=i,t[".key"]=s)})),t):t},levels:function(){return this.config.levels},currentLevel:function(){var e=this,t={};return f.a.mapValues(this.levels,(function(i){e.userData.score>=i.min&&e.userData.score<=i.max&&(t=i)})),t},userIsDefined:function(){return null!=this.userInfo&&!!Object.keys(this.userInfo).length},routerQuery:function(){return this.$route.query}},methods:{logout:function(){var e=this;n.a.auth().signOut().then((function(){e.userInfo={},e.$router.replace("login")}))},setUser:function(e){this.userInfo=e||{}},setTutorial:function(e){this.db.ref("/users/".concat(this.userInfo.displayName)).child("taken_tutorial").set(e),this.$router.replace("play")},openConfig:function(){this.showConfig=!0},closeConfig:function(){this.showConfig=!1}},created:function(){var e=this;this.$route.query.config&&c.a.get(this.$route.query.config).then((function(t){e.config=t.data})).catch((function(){}))}},Ze=Xe,et=(i("034f"),Object(C["a"])(Ze,a,o,!1,null,null,null)),tt=et.exports,it=(i("45fc"),i("b0c0"),i("8c4f")),st=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"about"}},[i("h1",[e._v("About")]),i("b-container",[i("p",[e._v(" You get points for each sample you annotate. ")]),i("p",[e._v(" You can unlock the following animals based on the number of points you have: ")]),i("b-container",{staticClass:"p-4",attrs:{fluid:""}},[i("b-row",e._l(e.levelsWithImages,(function(t){return i("b-col",{key:t.level},[i("div",[i("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img_grey,alt:"Thumbnail"}}),i("br"),e._v(" Level "+e._s(t.level)+" "),i("br"),i("span",[e._v(e._s(t.min)+" points")])],1)])})),1)],1)],1)],1)},rt=[],nt=(i("4de4"),i("13d5"),i("4fad"),i("3835")),at={name:"about",data:function(){return{}},props:{levels:{type:Object,required:!1}},computed:{levelsWithImages:function(){return Object.entries(this.levels).filter((function(e){return e[1].img})).reduce((function(e,t){var i=Object(nt["a"])(t,2),s=i[0],r=i[1];return e[s]=r,e}),{})}}},ot=at,ut=(i("b8ab"),Object(C["a"])(ot,st,rt,!1,null,null,null)),lt=ut.exports,ct=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"admin"}},[i("h1",[e._v("Admin")]),i("b-container",["complete"==e.status?i("p",{staticClass:"lead"},[e._v(" You have "+e._s(e.sampleCounts.length)+" items currently ")]):e._e(),"json"===e.manifestType?i("p",[i("b",[e._v("Data Source:")]),i("a",{attrs:{href:e.config.manifestUrl}},[e._v(e._s(e.config.manifestUrl))])]):"pubmed"===e.manifestType?i("p",[i("b",[e._v("Pubmed Query:")]),e._v(" "+e._s(e.config.manifestQuery)+" ")]):"github"===e.manifestType?i("p",[i("b",[e._v("Github User:")]),e._v(" "+e._s(e.config.manifestGitHub.user)+" "),i("br"),i("b",[e._v("Github Repo:")]),e._v(" "+e._s(e.config.manifestGitHub.repo)+" "),i("br"),i("b",[e._v("Github Path:")]),e._v(" "+e._s(e.config.manifestGitHub.path)+" "),i("br")]):"S3"===e.manifestType?i("p",[i("b",[e._v("S3 bucket:")]),e._v(" "+e._s(e.config.manifestS3.bucket)+" "),i("br"),i("b",[e._v("prefix:")]),e._v(" "+e._s(e.config.manifestS3.prefix)+" "),i("br"),i("b",[e._v("delimiter:")]),e._v(" "+e._s(e.config.manifestS3.delimiter)+" "),i("br")]):e._e(),i("b-button",{attrs:{variant:"warning"},on:{click:e.previewManifest}},[i("span",[e._v(" Preview ")])]),e.manifestEntries.length?i("div",{staticClass:"mt-3 pt-3"},["json"===e.manifestType?i("small",[e._v(" Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total ")]):"pubmed"===e.manifestType?i("small",[e._v(" Here are a few pubmed IDs from your search. There are "+e._s(e.pubmedQueryStore.count)+" items in total. ")]):e._e(),"github"===e.manifestType?i("small",[e._v(" Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total ")]):e._e(),"S3"===e.manifestType?i("small",[e._v(" Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total ")]):e._e(),i("textarea",{staticClass:"mt-3 mb-3 ml-3 mr-3 w-100",attrs:{disabled:"",rows:"5"},domProps:{value:e.manifestEntries.slice(0,100)+"..."}})]):e._e(),"complete"==e.status?i("p",{staticClass:"mt-3 pt-3"},[e._v(" Click the button below to sync your firebase database with your manifest. ")]):e._e(),i("div",{staticClass:"mb-3 pb-3"},["complete"==e.status?i("b-button",{on:{click:e.refreshSamples}},[i("span",[e._v(" Refresh Sample List ")])]):i("div",[i("p",[e._v(e._s(e.status)+" "+e._s(e.progress)+" / "+e._s(e.manifestEntries.length))]),i("b-progress",{staticClass:"mb-2",attrs:{value:e.progress,max:e.manifestEntries.length,variant:"info",striped:""}})],1)],1)],1)],1)},dt=[],mt=(i("c975"),i("ea06")),pt=i.n(mt),ft={name:"admin",data:function(){return{status:"loading...",progress:0,manifestEntries:[],sampleCounts:[],pubmedQueryStore:{},continuation:null}},props:{levels:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},mounted:function(){this.addFirebaseListener()},computed:{manifestType:function(){var e=null;return e=this.config.manifestType?this.config.manifestType:"json",e}},methods:{addFirebaseListener:function(){var e=this;this.db.ref("sampleCounts").once("value",(function(t){e.sampleCounts=f.a.map(t.val(),(function(e,t){return{".key":t,".value":e}})),e.status="complete"}))},xmlParser:function(e){var t=new DOMParser,i=t.parseFromString(e,"text/xml");return i},getPubmedQueryPreview:function(){var e=this,t="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi",i="".concat(t,"?db=pubmed&term=").concat(encodeURI(this.config.manifestQuery),"&usehistory=y&retmax=100");return c.a.get(i).then((function(t){var i=e.xmlParser(t.data),s=i.getElementsByTagName("WebEnv")[0],r=i.getElementsByTagName("Count")[0],n=i.getElementsByTagName("IdList")[0].children;e.pubmedQueryStore.webEnv=s.innerHTML,e.pubmedQueryStore.count=r.innerHTML,e.manifestEntries=f.a.map(n,(function(e){return e.innerHTML}))}))},getPubmedQueryFull:function(){var e=this,t="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi";if(this.pubmedQueryStore.webEnv){var i="".concat(t,"?db=pubmed&term=").concat(encodeURI(this.config.manifestQuery),"&usehistory=y&retmax=").concat(this.pubmedQueryStore.count,"&WebEnv=").concat(this.pubmedQueryStore.webEnv);c.a.get(i).then((function(t){var i=e.xmlParser(t.data),s=i.getElementsByTagName("IdList")[0].children;e.manifestEntries=f.a.map(s,(function(e){return e.innerHTML})),e.syncEntries()}))}else this.getPubmedQueryPreview().then((function(){e.getPubmedQueryFull()}))},getGithubManifest:function(){var e=this,t="https://api.github.com/repos/".concat(this.config.manifestGitHub.user,"/");return t+="".concat(this.config.manifestGitHub.repo,"/contents/").concat(this.config.manifestGitHub.path),c.a.get(t).then((function(t){e.manifestEntries=f.a.map(t.data,(function(e){return e.name.split(".")[0]}))}))},parseS3:function(e){var t=this,i=this.xmlParser(e),s=i.getElementsByTagName("Key"),r=i.getElementsByTagName("NextContinuationToken"),n=i.getElementsByTagName("IsTruncated")[0].innerHTML;this.continuation="true"===n?encodeURIComponent(r[0].innerHTML):null;var a=f.a.map(s,(function(e){return e.innerHTML})),o=f.a.filter(a,(function(e){return e.replace("".concat(t.config.manifestS3.prefix,"/"),"")})),u=f.a.map(o,(function(e){return e.replace("".concat(t.config.manifestS3.prefix,"/"),"").split(".")[0]}));return u},S3Continuation:function(e){var t=this,i="https://s3-us-west-2.amazonaws.com/".concat(this.config.manifestS3.bucket,"/?list-type=2&");return i+="prefix=".concat(this.config.manifestS3.prefix,"/&max-keys=").concat(this.config.manifestS3.max_keys),i+="&delimiter=".concat(this.config.manifestS3.delimiter),i+="&continuation-token=".concat(e),e?c.a.get(i).then((function(e){var i=t.parseS3(e.data);t.manifestEntries=f.a.uniq(t.manifestEntries.concat(i)),t.continuation&&t.S3Continuation(t.continuation)})):0},getS3Manifest:function(){var e=this,t="https://s3-us-west-2.amazonaws.com/".concat(this.config.manifestS3.bucket,"/?list-type=2&");return t+="prefix=".concat(this.config.manifestS3.prefix,"/&max-keys=").concat(this.config.manifestS3.max_keys),t+="&delimiter=".concat(this.config.manifestS3.delimiter),c.a.get(t).then((function(t){var i=e.parseS3(t.data);e.manifestEntries=f.a.uniq(e.manifestEntries.concat(i)),e.continuation&&e.S3Continuation(e.continuation)}))},previewManifest:function(){var e=this;"json"===this.manifestType?c.a.get(this.config.manifestUrl).then((function(t){e.manifestEntries=t.data})):"pubmed"===this.manifestType?this.getPubmedQueryPreview():"github"===this.manifestType?this.getGithubManifest():"S3"===this.manifestType&&this.getS3Manifest()},refreshSamples:function(){var e=this;this.status="refreshing","json"===this.manifestType?c.a.get(this.config.manifestUrl).then((function(t){var i=t.data;e.manifestEntries=i,e.syncEntries()})):"pubmed"===this.manifestType?this.getPubmedQueryFull():"github"===this.manifestType?this.getGithubManifest().then((function(){e.syncEntries()})):"S3"===this.manifestType&&(this.manifestEntries.length?this.syncEntries():(alert("please press the preview button first, and wait to get the final count"),this.status="complete"))},syncEntries:function(){var e=this,t=f.a.map(this.sampleCounts,(function(e){return e[".key"]})),i=this,s=new pt.a;s.postMessage([this.manifestEntries,t,i.config.firebaseKeys]),s.onmessage=function(e){i.status="complete","done"===e.data?i.addFirebaseListener():i.progress+=1},f.a.map(t,(function(t){e.manifestEntries.indexOf(t)<0&&e.db.ref("sampleCounts").child(t).remove()}))}}},ht=ft,gt=Object(C["a"])(ht,ct,dt,!1,null,null,null),vt=gt.exports,bt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home container"},[i("div",{staticClass:"jumbotron landing",style:e.landingStyle},[i("h1",[e._v(e._s(e.title))]),i("p",{staticClass:"lead buttons mt-3"},[e._v(" "+e._s(e.tagline)+" ")]),i("p",{staticClass:"buttons mt-3"},[i("router-link",{staticClass:"btn btn-primary white",attrs:{to:{name:"Play",query:e.routerQuery}}},[e._v(" Play Now ")]),i("router-link",{staticClass:"btn btn-primary white mx-1",attrs:{to:{name:"Tutorial",query:e.routerQuery}}},[e._v(" Tutorial ")])],1)])])},yt=[],wt={name:"Home",props:{config:{type:Object,required:!0},routerQuery:{type:Object}},data:function(){return{}},computed:{title:function(){return this.config.home.title},tagline:function(){return this.config.home.tagline},landingStyle:function(){return{"background-image":'url("'.concat(this.config.home.backgroundUrl,'")')}}}},St=wt,_t=(i("304d"),Object(C["a"])(St,bt,yt,!1,null,"7f617f0b",null)),Ct=_t.exports,kt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"profile"}},[i("b-container",{attrs:{fluid:""}},[i("h1",[e.currentLevel.img?i("b-img",{staticClass:"m-1",attrs:{rounded:"circle",width:"75",height:"75","blank-color":"#777",alt:"img",src:e.currentLevel.img}}):e._e(),e._v(" "+e._s(e.userInfo.displayName)+" ")],1),i("p",{staticClass:"lead"},[e._v("You have "+e._s(e.userData.score)+" points!")]),i("hr"),i("h3",[e._v("Level "+e._s(e.currentLevel.level))]),i("p",{staticClass:"lead"},[e._v(" Keep playing to unlock the remaining animals! ")]),i("b-container",{staticClass:"p-4",attrs:{fluid:""}},[i("b-row",e._l(e.levelsWithImages,(function(t){return i("b-col",{key:t.min},[i("div",[t.level<=e.currentLevel.level?i("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img,alt:"Thumbnail"}}):i("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img_grey,alt:"Thumbnail"}}),i("br"),e._v(" Level "+e._s(t.level)+" "),i("br"),t.level>e.currentLevel.level?i("span",[e._v(e._s(t.min)+" points")]):e._e()],1)])})),1)],1),i("hr"),e.chats.length?i("div",[i("h2",[e._v("Your Chats")]),i("p",{staticClass:"lead"},[e._v(" Your discussions on specific samples ")]),e._l(e.chats,(function(t){return i("div",{key:t,staticClass:"text-left"},[e.chatInfo[t]?i("div",[i("b-alert",{attrs:{show:e.chatInfo[t].notify}},[i("router-link",{attrs:{to:"/listen/"+t}},[e._v(e._s(t))]),e._v(": "),i("b",[e._v(e._s(e.chatInfo[t].username))]),e._v(" "+e._s(e.chatInfo[t].message)+" ")],1),i("b-alert",{attrs:{show:!e.chatInfo[t].notify,variant:"light"}},[i("router-link",{attrs:{to:"/review/"+t}},[e._v(e._s(t))]),e._v(": "),i("b",[e._v(e._s(e.chatInfo[t].username))]),e._v(" "+e._s(e.chatInfo[t].message)+" ")],1)],1):e._e()])}))],2):i("div",[i("h2",[e._v("Chats")]),i("p",{staticClass:"lead"},[e._v(" You haven't said anything yet! When you're ready, join the discussion. ")]),i("img",{staticClass:"blankImage",attrs:{src:e.blankImage}})])],1)],1)},xt=[],Tt={name:"profile",data:function(){return{chats:[],chatInfo:{}}},computed:{blankImage:function(){return this.config.profile.blankImage},levelsWithImages:function(){return Object.entries(this.levels).filter((function(e){return e[1].img})).reduce((function(e,t){var i=Object(nt["a"])(t,2),s=i[0],r=i[1];return e[s]=r,e}),{})}},props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},mounted:function(){this.userData[".key"]&&this.getUserChats()},watch:{userData:function(){this.userData[".key"]&&this.getUserChats()},chats:function(){var e=this;this.chats.forEach((function(t){e.db.ref("chats").child("sampleChats").child(t).orderByKey().limitToLast(1).on("value",(function(i){var s=i.val();e.chatInfo[t]=s[Object.keys(s)[0]],e.getNotifications(t),e.$forceUpdate()}))}))}},methods:{getUserChats:function(){var e=this;this.db.ref("chats").child("userChat").child(this.userData[".key"]).on("value",(function(t){var i=t.val();i&&(e.chats=Object.keys(i))}))},getNotifications:function(e){var t=this;this.db.ref("notifications").child(this.userData[".key"]).child(e).on("value",(function(i){i.val()&&(t.chatInfo[e].notify=!0,t.$forceUpdate())}))}}},It=Tt,jt=(i("1be2"),Object(C["a"])(It,kt,xt,!1,null,null,null)),Pt=jt.exports,Ot=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container",attrs:{id:"play"}},[i("b-modal",{ref:"levelUp",attrs:{id:"levelUp",title:"You've Levelled Up!","ok-only":""}},[i("div",{staticClass:"my-4"},[i("h3",[e._v("Level "+e._s(e.currentLevel.level))]),i("img",{attrs:{src:e.currentLevel.img,width:"120px",height:"120px"}}),i("p",{staticClass:"lead"},[e._v("You've unlocked: "+e._s(e.currentLevel.character))])])]),i("div",{staticClass:"main"},[i("b-alert",{staticClass:"toast",attrs:{show:e.dismissCountDown,variant:e.feedback.variant},on:{dismissed:function(t){e.dismissCountdown=0},"dismiss-count-down":e.countDownChanged}},[e._v(" "+e._s(e.feedback.message)+" ")]),e.noData?i("div",[i("h1",[e._v("There is no data in your database!")]),i("p",{staticClass:"lead"},[e._v(" Follow the instructions to set up your SwipesForScience App ")]),i("img",{staticClass:"blankImage",attrs:{src:e.blankImage,alt:"there is no data"}})]):i("div",[e.widgetPointer?i("WidgetSelector",{ref:"widget",attrs:{widgetType:e.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,needsSecret:e.needsSecret,serverSecret:e.serverSecret,playMode:"play"},on:{widgetRating:e.sendWidgetResponse,setStartTime:e.setStartTime,updateUserSettings:e.updateUserSettings}}):i("div",[i("Flask"),i("p",{staticClass:"mt-3 pt-3 lead"},[e._v("loading...")])],1)],1)],1)],1)},Lt=[],Et=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"WidgetSelector"},[i("Secret",{attrs:{userSettings:e.userSettings,needsSecret:e.needsSecret,serverSecret:e.serverSecret},on:{updateUserSettings:e.updateUserSettings}},["ImageSwipe"==e.widgetType?i("ImageSwipe",{ref:"ImageSwipe",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):e._e(),"TimedImageSwipe"==e.widgetType?i("TimedImageSwipe",{ref:"TimedImageSwipe",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,setStartTime:e.setStartTime,updateUserSettings:e.updateUserSettings}}):i("TemplateWidget",{ref:"TemplateWidget",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}})],1)],1)},qt=[],$t=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetSecret"},[!e.passesSecret&&e.needsSecret?i("div",{staticClass:"mx-auto",attrs:{id:"signupForm"}},[e.userSettings.secret?i("div",[i("b-alert",{attrs:{variant:"danger",show:""}},[e._v(" Oh no! You didn't enter the right secret! Try again. ")])],1):e._e(),i("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[i("b-form",{on:{submit:e.onSubmit}},[i("b-form-group",{attrs:{id:"secretInputGroup",label:"Secret:","label-for":"secret"}},[i("b-form-input",{attrs:{id:"secret",type:"text",required:"",placeholder:"Enter Secret"},model:{value:e.form.secret,callback:function(t){e.$set(e.form,"secret",t)},expression:"form.secret"}})],1),i("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:e.onSubmit}},[e._v("Submit")])],1)],1)]):e.passesSecret||!e.needsSecret?i("div",[e._t("default")],2):e._e()])},Ut=[],At=i("5530"),Ft={name:"SecretWidget",props:{userSettings:{type:Object,required:!0},needsSecret:{type:Boolean,required:!1,default:!1},serverSecret:{type:String,required:!1}},data:function(){return{form:{secret:null}}},computed:{passesSecret:function(){return this.needsSecret&&this.userSettings.secret?btoa(this.userSettings.secret)===this.serverSecret:!this.needsSecret}},methods:{onSubmit:function(e){e.preventDefault();var t=Object(At["a"])({},this.userSettings);t.secret=this.form.secret,this.$emit("updateUserSettings",t)}}},Mt=Ft,Nt=Object(C["a"])(Mt,$t,Ut,!1,null,null,null),Dt=Nt.exports,zt={name:"WidgetSelector",props:{widgetType:{type:String,required:!0},widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},userSettings:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1},needsSecret:{type:Boolean,required:!1},serverSecret:{type:String,required:!1}},components:{ImageSwipe:se,TimedImageSwipe:le,TemplateWidget:he,Secret:Dt},methods:{getFeedback:function(e){return this.$refs[this.widgetType].getFeedback(e)},getScore:function(e){return this.$refs[this.widgetType].getScore(e)},getSummary:function(e){return this.$refs[this.widgetType].getSummary(e)},widgetRating:function(e){this.$emit("widgetRating",e)},setStartTime:function(e){this.$emit("setStartTime",e)},updateUserSettings:function(e){this.$emit("updateUserSettings",e)}}},Rt=zt,Vt=Object(C["a"])(Rt,Et,qt,!1,null,null,null),Ht=Vt.exports,Bt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"flask"}},[i("div",{staticClass:"background"}),i("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 113 130","xml:space":"preserve"}},[i("g",[i("path",{attrs:{fill:"#FFFFFF",d:"M0,0v130h112.084L111.75,0H0z M94.75,128C71,128,56,128,56,128s-14.873,0-38.623,0s-13.945-19.422-6.33-35.945S40,41.25,40,41.25V3h16h11v38.25c0,0,23.901,34.283,31.517,50.805S118.5,128,94.75,128z"}}),i("path",{attrs:{fill:"none",stroke:"#000000","stroke-width":"3","stroke-miterlimit":"10",d:"M56,127.5c0,0-14.873,0-38.623,0s-13.695-19.172-6.08-35.695C18.912,75.283,40.5,41.25,40.5,41.25V2.5h-9H56h19.5h-8v38.75c0,0,23.651,34.033,31.267,50.555c7.615,16.523,19.733,35.695-4.017,35.695S56,127.5,56,127.5z"}})])]),i("div",{staticClass:"bubble b0"}),i("div",{staticClass:"bubble b1"}),i("div",{staticClass:"bubble b2"}),i("div",{staticClass:"bubble b3"}),i("div",{staticClass:"bubble b4"}),i("div",{staticClass:"bubble b5"}),i("div",{staticClass:"bubble b6"}),i("div",{staticClass:"bubble b7"}),i("div",{staticClass:"bubble b8"}),i("div",{staticClass:"bubble b9"}),i("div",{staticClass:"swirl s0"}),i("div",{staticClass:"swirl s1"}),i("div",{staticClass:"swirl s2"}),i("div",{staticClass:"swirl s3"}),i("div",{staticClass:"swirl s4"}),i("div",{staticClass:"swirl s5"})])},Wt=[],Qt={name:"flask"},Gt=Qt,Kt=(i("080e"),Object(C["a"])(Gt,Bt,Wt,!1,null,"3c24b5a6",null)),Yt=Kt.exports;s["default"].component("WidgetSelector",Ht);var Jt={name:"play",props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},data:function(){return{startTime:null,dismissSecs:1,dismissCountDown:0,feedback:{variant:"warning",message:""},status:"loading",sampleCounts:[],userSeenSamples:[],noData:!1,widgetPointer:null,widgetSummary:{},userSettings:{},serverSecret:""}},watch:{currentLevel:function(){this.userData.score===this.currentLevel.min&&this.currentLevel.min&&(this.$refs.levelUp.show(),this.db.ref("/users/".concat(this.userInfo.displayName)).child("level").set(this.currentLevel.level))},widgetPointer:function(){var e=this;this.widgetPointer&&this.db.ref("sampleSummary").child(this.widgetPointer).once("value",(function(t){e.widgetSummary=t.val()}))}},mounted:function(){this.initSampleCounts(),this.initSeenSamples(),this.initUserSettings(),this.fetchServerSecret()},components:{Flask:Yt},computed:{samplePriority:function(){return f.a.sortBy(this.sampleCounts,".value")},blankImage:function(){return this.config.play.blankImage},widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties},needsSecret:function(){return this.config.widgetUsesSecret}},methods:{initUserSettings:function(){var e=this;this.db.ref("userSettings").child(this.userInfo.displayName).on("value",(function(t){var i=t.val();e.userSettings=null==i?{}:i}))},updateUserSettings:function(e){e&&this.db.ref("userSettings").child(this.userInfo.displayName).set(e)},initSampleCounts:function(){var e=this;this.db.ref("sampleCounts").once("value",(function(t){e.sampleCounts=f.a.map(t.val(),(function(e,t){return{".key":t,".value":e}})),e.sampleCounts.length?(e.startTime=new Date,e.setNextSampleId()):e.noData=!0}))},initSeenSamples:function(){var e=this;this.db.ref("userSeenSamples").child(this.userInfo.displayName).once("value",(function(t){e.userSeenSamples=f.a.map(t.val(),(function(e,t){return{".key":t,".value":e}}))}))},shuffle:function(e){var t,i,s=e.length;while(0!==s)i=Math.floor(Math.random()*s),s-=1,t=e[s],e[s]=e[i],e[i]=t;return e},sampleUserPriority:function(){if(this.userInfo){var e;if(this.userSeenSamples){var t=f.a.map(this.userSeenSamples,(function(e){return e[".key"]}));e=f.a.filter(this.samplePriority,(function(e){return t.indexOf(e[".key"])<0})),e=e.length?e:this.samplePriority}else e=this.samplePriority;if(e.length){var i=e[0][".value"],s=f.a.filter(e,(function(e){return e[".value"]===i}));return this.shuffle(s)}return this.shuffle(this.samplePriority)}return null},setStartTime:function(e){this.startTime=e},sendWidgetResponse:function(e){var t=new Date-this.startTime,i=this.$refs.widget.getFeedback(e);i.show&&(this.feedback=i,this.showAlert()),this.sendVote(e,t),this.updateScore(this.$refs.widget.getScore(e)),this.updateSummary(this.$refs.widget.getSummary(e)),this.updateCount(),this.updateSeen(),this.setNextSampleId()},setNextSampleId:function(){this.startTime=new Date;var e=this.sampleUserPriority()[0];e&&(this.widgetPointer=e[".key"])},sendVote:function(e,t){this.db.ref("votes").push({user:this.userInfo.displayName,sample:this.widgetPointer,response:e,time:t})},updateScore:function(e){this.db.ref("users").child(this.userInfo.displayName).child("score").transaction((function(t){return(t||0)+e}))},updateSummary:function(e){this.db.ref("sampleSummary").child(this.widgetPointer).set(e)},updateCount:function(){var e=this;this.db.ref("sampleCounts").child(this.widgetPointer).transaction((function(e){return(e||0)+1})),f.a.map(this.sampleCounts,(function(t){t[".key"]===e.widgetPointer&&(t[".value"]+=1)}))},updateSeen:function(){this.db.ref("userSeenSamples").child(this.userInfo.displayName).child(this.widgetPointer).transaction((function(e){return(e||0)+1})),this.userSeenSamples.push({".key":this.widgetPointer,".value":1})},countDownChanged:function(e){this.dismissCountDown=e},showAlert:function(){this.dismissCountDown=this.dismissSecs},fetchServerSecret:function(){var e=this;this.db.ref("settings").child("secret").once("value").then((function(t){e.serverSecret=t.val()}))}}},Xt=Jt,Zt=(i("7975"),Object(C["a"])(Xt,Ot,Lt,!1,null,null,null)),ei=Zt.exports,ti=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"login"}},[i("h1",[e._v("Log In")]),i("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[i("b-alert",{attrs:{show:e.errors.show,variant:"danger"}},[e._v(e._s(e.errors.message))]),i("b-form",{on:{submit:e.onSubmit}},[i("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress"}},[i("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),i("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[i("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Submit")])],1),i("p",{staticClass:"mt-3"},[e._v(" Don't have an account? "),i("router-link",{attrs:{to:{name:"SignUp",query:e.routerQuery}}},[e._v("Create one")])],1)],1)])},ii=[],si={name:"login",props:{routerQuery:{type:Object}},data:function(){return{form:{email:null,password:null},errors:{show:!1,message:null}}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),n.a.auth().signInWithEmailAndPassword(this.form.email,this.form.password).then((function(e){t.$emit("login",e),t.$router.push({name:"Play",query:t.routerQuery})}),(function(e){t.errors.show=!0,t.errors.message=e.message}))}}},ri=si,ni=(i("039a"),Object(C["a"])(ri,ti,ii,!1,null,null,null)),ai=ni.exports,oi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"signup"}},[i("h1",[e._v("Sign Up")]),i("b-modal",{ref:"consentform",attrs:{id:"consentform",title:"Consent Form",size:"lg"}},[i("terms"),i("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("b-form",{on:{submit:e.saveConsent}},[i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("I Consent")])],1)],1)],1),i("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[i("b-form",{attrs:{validated:""},on:{submit:e.onSubmit}},[i("b-alert",{attrs:{show:e.errors.show,variant:"danger"}},[e._v(e._s(e.errors.message))]),i("b-form-group",{attrs:{id:"consentOpenButton",label:e.consentFormLabel,"label-for":"openConsent"}},[e.form.consented?e._e():i("b-button",{attrs:{variant:"success",id:"openConsent"},on:{click:e.openConsentModal}},[e._v(" Open Consent Form ")])],1),i("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress",description:"We'll never share your email with anyone else."}},[i("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),i("b-form-group",{attrs:{id:"usernameInputGroup",label:"Username:","label-for":"usernameInput",description:"This will be displayed on the leaderboard"}},[i("b-form-input",{attrs:{id:"usernameInput",type:"text",required:"",placeholder:"Choose a username"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),i("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[i("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),i("b-form-group",{attrs:{id:"password2InputGroup",label:"Password Again:","label-for":"password2Input"}},[i("b-alert",{attrs:{show:!e.validated,variant:"danger"}},[e._v(" Make sure your passwords match! ")]),i("b-form-input",{attrs:{id:"password2Input",type:"password",required:"",placeholder:"Confirm password"},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1),i("b-button",{attrs:{type:"submit",variant:"primary",disabled:!e.validated||!e.form.consented}},[e._v("Submit")]),i("p",{staticClass:"mt-3"},[e._v(" Already have an account? "),i("router-link",{attrs:{to:"/login"}},[e._v("Log In")])],1)],1)],1)],1)},ui=[],li=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"terms"}},[e._v(" Input your terms and conditions (e.g. a consent form) here. ")])},ci=[],di={name:"terms",data:function(){return{}}},mi=di,pi=Object(C["a"])(mi,li,ci,!1,null,null,null),fi=pi.exports,hi={name:"signup",data:function(){return{form:{email:"",password:"",password2:"",username:"",consented:!1},errors:{show:!1,message:null}}},props:{config:{type:Object,required:!0}},components:{terms:fi},computed:{validated:function(){return this.form.password===this.form.password2},consentFormLabel:function(){return this.form.consented?"You have consented!":"Click to read and sign the consent form"}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),n.a.database().ref("users").child(this.form.username).once("value").then((function(e){var i=e.val();i?(t.errors.show=!0,t.errors.message="Username already exists! Please choose a unique username"):t.createAccount()}))},saveConsent:function(e){e.preventDefault(),this.form.consented=!0,this.$refs.consentform.hide()},openConsentModal:function(){this.$refs.consentform.show()},createAccount:function(){var e=this;n.a.auth().createUserWithEmailAndPassword(this.form.email,this.form.password).then((function(t){var i=t.user;e.updateProfile(i)}),(function(t){e.errors.show=!0,e.errors.message=t.message}))},insertUser:function(e){n.a.database().ref("users").child(e.displayName).set({score:0,level:0,admin:!1,taken_tutorial:!1,consent:this.form.consented,consentedOn:new Date}).then((function(){})).catch((function(){}))},updateProfile:function(e){var t=this;e.updateProfile({displayName:this.form.username}).then((function(){t.insertUser(e),t.config.needsTutorial?t.$router.replace("tutorial"):t.$router.replace("play")}),(function(e){t.errors.show=!0,t.errors.message=e.message}))}}},gi=hi,vi=(i("56c9"),Object(C["a"])(gi,oi,ui,!1,null,null,null)),bi=vi.exports,yi=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},wi=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"unauthorized"}},[i("h1",[e._v("Oops! You are not authorized")]),i("p",[e._v("Please contact the sysadmin to get access to this page")])])}],Si={name:"unauthorized",data:function(){return{}}},_i=Si,Ci=Object(C["a"])(_i,yi,wi,!1,null,null,null),ki=Ci.exports,xi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[e._m(0),s("div",{staticClass:"page__content grey-gradient-bg"},[s("div",{staticClass:"page__content-container"},[s("div",{staticClass:"leaderboard"},[s("transition-group",{staticClass:"leaderboard__rows",attrs:{tag:"div",name:"list"}},e._l(e.displayUsersList,(function(t,r){return s("div",{key:t.name,staticClass:"leaderboard__row"},[s("div",{staticClass:"leaderboard__row-container"},[s("div",{staticClass:"leaderboard__cell user-index"},[e._v(e._s(r+1))]),s("div",{staticClass:"leaderboard__cell avatar"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:i("95a6"),alt:"Swipes for Science logo"}})])]),s("div",{staticClass:"leaderboard__cell username"},[e._v(e._s(t.name))]),0===r?s("div",{staticClass:"leaderboard__cell crown"},[s("img",{attrs:{src:i("5116"),alt:"Medal"}})]):e._e(),s("div",{staticClass:"leaderboard__cell user-score"},[s("div",[e._v(e._s(t.score))])])]),s("hr",{staticClass:"dashed-decorative-line"})])})),0),e.displayLimit<e.sortedUsersList.length?s("button",{staticClass:"full-size-desktop",attrs:{id:"leaderboard__showMore"},on:{click:function(t){return e.showMore()}}},[e._v(" Load more ")]):e._e()],1)])])])},Ti=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page__header"},[i("h1",[e._v("Leaderboard")])])}],Ii=(i("fb6a"),{name:"leaderboard",props:{levels:{type:Object,required:!0},allUsers:{type:Object,required:!0}},computed:{sortedUsersList:function(){var e=this,t=Object.keys(this.allUsers).filter((function(e){return".key"!==e}));return t=t.map((function(t){return{name:t,score:e.allUsers[t].score}})),t.sort((function(e,t){return t.score-e.score})),t},displayUsersList:function(){return this.sortedUsersList.slice(0,this.displayLimit)}},data:function(){return{sortBy:"score",sortDesc:!0,fields:["rank","badge",{key:".key",label:"Player",sortable:!1},{key:"score",label:"Score",sortable:!0}],displayLimit:10}},methods:{showMore:function(){this.displayLimit=this.displayLimit<this.sortedUsersList.length?Math.min(this.displayLimit+10,this.sortedUsersList.length):this.displayLimit}}}),ji=Ii,Pi=(i("f3a5"),Object(C["a"])(ji,xi,Ti,!1,null,null,null)),Oi=Pi.exports,Li=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"tutorial",staticClass:"tutorial"},["Bubbles"==e.backgroundAnimation?i("Bubbles"):e._e(),e._m(0),e.currentBin.bin?i("div",{staticClass:"pbar pt-3 pb-3"},[i("b-progress",{staticClass:"ml-3 mr-3",attrs:{value:e.scrollPosition,max:1,"show-progress":""}})],1):e._e(),e._l(e.steps.intro,(function(t,s){return i("div",{key:t.key,ref:t.key,refInFor:!0,staticClass:"fullpage video-trigger"},[i("div",{attrs:{id:"intro"+s}},[i("p",{domProps:{innerHTML:e._s(t.text)}}),i("span",{staticClass:"invisible"},[e._v(e._s(t.text))])]),i("img",{staticClass:"mt-3 pt-3 img",attrs:{src:t.image}})])})),e._l(e.steps.examples,(function(t,s){return i("div",{key:t.key,ref:t.key,refInFor:!0,staticClass:"fullpage video-trigger"},[i("div",{staticClass:"text-center message w-100",attrs:{id:"example"+s}},[i("p",{domProps:{innerHTML:e._s(t.text)}}),i("span",{staticClass:"invisible"},[e._v(e._s(t.text))]),t.pointer?i("div",{staticClass:"mt-3"},[i("WidgetSelector",{ref:"widget",refInFor:!0,attrs:{widgetType:e.widgetType,widgetPointer:t.pointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,playMode:"tutorial",userSettings:e.userSettings,tutorialStep:t.tutorialStep},on:{widgetRating:e.triggerHelper}})],1):e._e(),t.tutorialCompleted?i("div",[i("b-button",{staticClass:"mt-3",on:{click:e.tutorialComplete}},[e._v("Play now")])],1):e._e()])])})),i("div",{class:"tutorial-helper "+(e.videoPaused?"not-playing":"")},[i("video",{ref:"tutorialVideo",staticClass:"video"},[i("source",{attrs:{src:e.video,type:"video/mp4"}})])]),e.bins.length-1!=e.currentBin.bin?i("div",{directives:[{name:"scroll-to",rawName:"v-scroll-to",value:e.nextStep,expression:"nextStep"}]},[i("Arrow")],1):e._e(),i("p")],2)},Ei=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h1",[e._v("Tutorial")]),i("p",{staticClass:"lead"},[e._v("Scroll down to learn how to play")])])}],qi=(i("7db0"),i("2909")),$i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("svg",{staticClass:"arrows"},[i("path",{staticClass:"a1",attrs:{d:"M0 0 L30 32 L60 0"}}),i("path",{staticClass:"a2",attrs:{d:"M0 20 L30 52 L60 20"}}),i("path",{staticClass:"a3",attrs:{d:"M0 40 L30 72 L60 40"}})])},Ui=[],Ai={name:"Arrow"},Fi=Ai,Mi=(i("6ac8"),Object(C["a"])(Fi,$i,Ui,!1,null,null,null)),Ni=Mi.exports,Di=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},zi=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bg",attrs:{id:"background-wrap"}},[i("div",{staticClass:"bubble x1"}),i("div",{staticClass:"bubble x2"}),i("div",{staticClass:"bubble x3"}),i("div",{staticClass:"bubble x4"}),i("div",{staticClass:"bubble x5"}),i("div",{staticClass:"bubble x6"}),i("div",{staticClass:"bubble x7"}),i("div",{staticClass:"bubble x8"}),i("div",{staticClass:"bubble x9"}),i("div",{staticClass:"bubble x10"})])}],Ri={name:"bubbles"},Vi=Ri,Hi=(i("dd79"),Object(C["a"])(Vi,Di,zi,!1,null,"fdd6d1d8",null)),Bi=Hi.exports,Wi=i("7625"),Qi=i.n(Wi),Gi=i("f13c");s["default"].use(Gi,{container:"body",duration:500,easing:"ease",offset:-75,force:!0,cancelable:!0,onStart:!1,onDone:!1,onCancel:!1,x:!1,y:!0});var Ki={name:"tutorial",components:{Arrow:Ni,Bubbles:Bi,WidgetSelector:Ht},data:function(){return{scrollPosition:0,widgetSummary:{},userSettings:{},video:Qi.a,videoEnd:2,videoPaused:!0,removeVideoListener:function(){},stepObservers:[]}},props:{levels:{type:Object,required:!0},config:{type:Object,required:!0}},watch:{},computed:{widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties},steps:function(){var e=this.config.tutorial.steps;return{intro:e.intro.map((function(e,t){return Object(At["a"])(Object(At["a"])({},e),{},{key:"intro."+t})})),examples:e.examples.map((function(e,t){return Object(At["a"])(Object(At["a"])({},e),{},{key:"examples."+t})}))}},allSteps:function(){return[].concat(Object(qi["a"])(this.steps.intro),Object(qi["a"])(this.steps.examples))},backgroundAnimation:function(){return this.config.tutorial.customBackgroundAnimation},bins:function(){for(var e=this.steps.intro.length+this.steps.examples.length,t=1/e,i=[],s=0;s<e;s+=1)i.push({bin:s,from:s*t,to:(s+1)*t});return i},currentBin:function(){var e=this,t=f.a.filter(this.bins,(function(t){return e.scrollPosition<=t.to&&e.scrollPosition>t.from}));return t.length?t[0]:{bin:0}},currentStage:function(){return this.currentBin.bin<this.steps.intro.length?Object(At["a"])(Object(At["a"])({},this.steps.intro[this.currentBin.bin]),{},{mode:"intro"}):Object(At["a"])(Object(At["a"])({},this.steps.examples[this.currentBin.bin-this.steps.intro.length]),{},{mode:"examples"})},nextStep:function(){return this.currentBin.bin<this.steps.intro.length-1?"#intro".concat(this.currentBin.bin+1):"#example".concat(this.currentBin.bin-this.steps.intro.length+1)}},methods:{tutorialComplete:function(){this.$emit("taken_tutorial",!0)},handleScroll:function(){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=(window.scrollY-60)/(this.$refs.tutorial.clientHeight-e);this.scrollPosition=t<0?0:t>1?1:t},playVideo:function(e,t){var i=this;this.videoPaused=!1;var s=this.$refs.tutorialVideo;s.removeEventListener("timeupdate",this.pause),s.currentTime=e||0,s.play(),this.videoEnd=t?e+t:s.duration,this.removeVideoListener=function(){s.removeEventListener("timeupdate",i.pause,!0),i.removeVideoListener=function(){}},s.addEventListener("timeupdate",this.pause,!0)},pause:function(){var e=this.$refs.tutorialVideo;e.currentTime>=this.videoEnd&&(e.pause(),this.removeVideoListener(),this.videoPaused=!0)},setVisibilityTriggers:function(){var e=this;this.allSteps.forEach((function(t){var i=e.$refs[t.key][0],s=new IntersectionObserver((function(i){var s,r=Object(nt["a"])(i,1),n=r[0];if(n.isIntersecting&&(null===t||void 0===t||null===(s=t.video)||void 0===s?void 0:s.onFocus)){var a=t.video.onFocus,o=a.start,u=a.duration;e.playVideo(o,u)}}),{threshold:[.6]});s.observe(i),e.stepObservers.push([s,i])}))},triggerHelper:function(e){var t,i,s=this.allSteps.find((function(t){return t.pointer===e.pointer})),r=s.answer,n=e.value===r,a=n?null===(t=s.video)||void 0===t?void 0:t.onCorrect:null===(i=s.video)||void 0===i?void 0:i.onIncorrect;a&&this.playVideo(a.start,a.duration)}},created:function(){window.addEventListener("scroll",this.handleScroll)},mounted:function(){this.setVisibilityTriggers()},beforeDestroy:function(){var e;null===(e=this.$refs.tutorialVideo)||void 0===e||e.removeEventListener("timeupdate",this.pause),window.removeEventListener("scroll",this.handleScroll),this.stepObservers.forEach((function(e){var t=Object(nt["a"])(e,2),i=t[0],s=t[1];i.unobserve(s)})),this.stepObservers=[]}},Yi=Ki,Ji=(i("c061"),i("19f0"),Object(C["a"])(Yi,Li,Ei,!1,null,"4a27ef7c",null)),Xi=Ji.exports,Zi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container",attrs:{id:"review"}},[i("div",{staticClass:"chat container"},[i("h3",{staticClass:"mb-2"},[e._v("Chat")]),e.chatOrder.length?i("div",{staticClass:"chatHistory pl-3 pr-3 pt-3 pb-3 mb-3"},e._l(e.chatOrder,(function(t){return i("p",{key:t.time,staticClass:"text-left"},[i("b",[e._v(e._s(t.username))]),e._v(": "+e._s(t.message)+" ")])})),0):i("div",[i("p",[e._v("No one has said anything yet!")])]),i("b-form",{on:{submit:e.sendChat}},[i("b-form-group",{attrs:{id:"exampleInputGroup1",label:"Enter chat message:","label-for":"exampleInput1",description:""}},[i("b-form-input",{attrs:{id:"exampleInput1",type:"text",required:"",placeholder:"Enter your message"},model:{value:e.chatMessage,callback:function(t){e.chatMessage=t},expression:"chatMessage"}}),i("b-button",{staticClass:"mt-2",attrs:{variant:"primary"},on:{click:e.sendChat}},[e._v("Send")])],1)],1)],1),i("div",[i("WidgetSelector",{ref:"widget",attrs:{widgetType:e.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,playMode:""}})],1)])},es=[],ts={name:"review",props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},components:{WidgetSelector:Ht},data:function(){return{widgetPointer:"",widgetSummary:{},userSettings:{},chatMessage:"",chatHistory:[]}},computed:{chatOrder:function(){var e=[];return f.a.mapValues(this.chatHistory,(function(t){e.push(t)})),e.reverse(),e},widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties}},watch:{$route:function(){this.widgetPointer=this.$route.params.key}},mounted:function(){this.widgetPointer=this.$route.params.key,this.setSampleInfo()},methods:{sendChat:function(e){var t=this;e.preventDefault();var i=this.$route.params.key;this.db.ref("chats").child("sampleChats").child(i).push({username:this.userData[".key"],message:this.chatMessage,time:(new Date).toISOString()}),this.db.ref("chats").child("sampleChatIndex").child(i).set({time:(new Date).toISOString()}),this.db.ref("chats").child("userChat").child(this.userData[".key"]).child(i).set({watch:1}),this.chatMessage="";var s=[];this.chatOrder.forEach((function(e){s.indexOf(e.username)<0&&e.username!==t.userData[".key"]&&s.push(e.username)})),s.forEach((function(e){t.db.ref("chats").child("userNotifications").child(e).child(i).set(!0)}))},unravelFirebaseListObject:function(e){var t=[];return f.a.mapValues(e,(function(e){t.push(e)})),t},setSampleInfo:function(){var e=this;this.db.ref("chats").child("sampleChats").child(this.widgetPointer).on("value",(function(t){var i=t.val();e.chatHistory=i})),this.userInfo.displayName&&this.db.ref("userSettings").child(this.userInfo.displayName).once("value").then((function(t){e.userSettings=t.val()||{}})),this.db.ref("sampleSummary").child(this.widgetPointer).on("value",(function(t){e.widgetSummary=t.val()}))}}},is=ts,ss=(i("18ec"),Object(C["a"])(is,Zi,es,!1,null,null,null)),rs=ss.exports,ns=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-container",[e.noData?i("div",[i("h1",[e._v("Chats")]),i("p",{staticClass:"lead"},[e._v("No one has said anything yet!")]),i("img",{staticClass:"blankImage",attrs:{src:e.blankChatImage}})]):i("div",[i("h1",[e._v("Chats")]),i("p",{staticClass:"lead"},[e._v("See which samples people are talking about")]),e._l(e.sampleChat,(function(t,s){return i("p",{key:s},[i("b-alert",{attrs:{show:""}},[i("router-link",{attrs:{to:"/review/"+t[".key"]}},[e._v(e._s(t[".key"]))]),i("br"),e.chatInfo[t[".key"]]?i("span",[i("b",[e._v(e._s(e.chatInfo[t[".key"]].username))]),e._v(" : "+e._s(e.chatInfo[t[".key"]].message)+" ")]):e._e()],1)],1)}))],2)])},as=[],os={firebase:function(){return{sampleChat:{source:this.db.ref("chats").child("sampleChatIndex").orderByChild("time"),readyCallback:function(){var e=this;this.sampleChat.forEach((function(t){e.db.ref("chats").child("sampleChats").child(t[".key"]).orderByKey().limitToLast(1).on("value",(function(i){var s=i.val();e.chatInfo[t[".key"]]=s[Object.keys(s)[0]],e.$forceUpdate()}))})),this.sampleChat.length||(this.noData=!0)}}}},data:function(){return{chatInfo:{},noData:!1}},props:{config:{type:Object,required:!0},db:{type:Object,required:!0}},computed:{orderedPosts:function(){var e=this.sampleChat;return e.reverse()},blankChatImage:function(){return this.config.chats.blankImage}}},us=os,ls=(i("6e45"),Object(C["a"])(us,ns,as,!1,null,null,null)),cs=ls.exports;s["default"].use(it["a"]);var ds=new it["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:[{path:"*",redirect:"/login"},{path:"/",name:"Home",component:Ct},{path:"/about",name:"About",component:lt},{path:"/profile",name:"Profile",component:Pt,meta:{requiresAuth:!0}},{path:"/play",name:"Play",component:ei,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:ai},{path:"/signup",name:"SignUp",component:bi},{path:"/terms",name:"Terms",component:fi},{path:"/unauthorized",name:"Unauthorized",component:ki},{path:"/leaderboard",name:"Leaderboard",component:Oi},{path:"/tutorial",name:"Tutorial",component:Xi},{path:"/chats",name:"Chats",component:cs,meta:{requiresAuth:!0}},{path:"/review/:key",name:"Review",component:rs},{path:"/admin",name:"Admin",component:vt,meta:{requiresAuth:!0,requiresAdmin:!0}}]});ds.beforeEach((function(e,t,i){var s=n.a.auth().currentUser,r=e.matched.some((function(e){return e.meta.requiresAuth})),a=e.matched.some((function(e){return e.meta.requiresAdmin}));r&&!s&&i({path:"/login",query:t.query}),"Play"===e.name&&(s?n.a.database().ref("/users/".concat(s.displayName)).once("value").then((function(e){var s=e.val();!s.taken_tutorial&&g.needsTutorial&&i({path:"/tutorial",query:t.query})})):i({path:"/login",query:t.query})),a?n.a.database().ref("/settings/admins/".concat(s.displayName)).once("value").then((function(e){a&&!e.val()?i("unauthorized"):i()})):i()}));var ms,ps=ds;s["default"].config.productionTip=!1,n.a.initializeApp(g.firebaseKeys),n.a.auth().onAuthStateChanged((function(){ms||(ms=new s["default"]({el:"#app",template:"<App/>",components:{App:tt},router:ps}))}))},"59d9":function(e,t,i){},"635e":function(e,t,i){},6816:function(e,t,i){"use strict";var s=i("c504"),r=i.n(s);r.a},6924:function(e,t,i){},"6ac8":function(e,t,i){"use strict";var s=i("84ac"),r=i.n(s);r.a},"6b4a":function(e,t,i){},"6e45":function(e,t,i){"use strict";var s=i("d80c"),r=i.n(s);r.a},7174:function(e,t,i){},7625:function(e,t,i){e.exports=i.p+"media/6bff0f6dab95402016a264862060e7f0.155ac36a.mp4"},7968:function(e,t,i){e.exports=i.p+"img/eLife-logo.4bb380cb.svg"},7975:function(e,t,i){"use strict";var s=i("231f"),r=i.n(s);r.a},"7dc5":function(e){e.exports=JSON.parse('{"needsTutorial":true,"manifestUrl":"https://raw.githubusercontent.com/jyeatman/SwipesForScience/master/data/manifest.json","manifestType":"json","widgetType":"TimedImageSwipe","widgetProperties":{"baseUrlTemplate":"https://roar-ldt-v2.s3.amazonaws.com/{0}.jpg","delimiter":"__","leftSwipe":{"label":"Fake","value":-1},"rightSwipe":{"label":"Real","value":1},"timing":{"stimulusDuration":"5000","stimulusFadeIn":false,"timeoutValue":"0","interStimuliDuration":"500"}},"iconAttribute":{"name":"openmoji","url":"http://openmoji.org"},"levels":{"0":{"level":0,"min":0,"max":4,"character":"worm","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1FAB1.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1FAB1.svg?sanitize=true"},"1":{"level":1,"min":5,"max":9,"character":"cricket","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F997.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F997.svg?sanitize=true"},"2":{"level":2,"min":10,"max":24,"character":"fish","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F41F.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F41F.svg?sanitize=true"},"3":{"level":3,"min":25,"max":49,"character":"frog","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F438.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F438.svg?sanitize=true"},"4":{"level":4,"min":50,"max":99,"character":"turtle","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F422.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F422.svg?sanitize=true"},"5":{"level":5,"min":100,"max":249,"character":"hedgehog","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F994.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F994.svg?sanitize=true"},"6":{"level":6,"min":250,"max":499,"character":"duck","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F986.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F986.svg?sanitize=true"},"7":{"level":7,"min":500,"max":999,"character":"koala","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F428.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F428.svg?sanitize=true"},"8":{"level":8,"min":1000,"max":2499,"character":"gorilla","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F98D.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F98D.svg?sanitize=true"},"9":{"level":9,"min":2500,"max":4999,"character":"mammoth","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F9A3.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F9A3.svg?sanitize=true"},"10":{"level":10,"min":5000,"max":7499,"character":"dragon","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F409.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F409.svg?sanitize=true"},"11":{"level":11,"min":7500,"max":9999,"character":"sauropod","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F995.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F995.svg?sanitize=true"},"12":{"level":12,"min":10000,"max":12499,"character":"unicorn","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F984.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F984.svg?sanitize=true"},"13":{"level":13,"min":12500,"max":20000,"character":"brain","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F9E0.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F9E0.svg?sanitize=true"}},"betaMode":false,"firebaseKeys":{"apiKey":"AIzaSyBC1IiNKg-AzveUj9_bwpASk8n5zE1Yy4c","authDomain":"gse-yeatman-lab.firebaseapp.com","databaseURL":"https://roar-ldt.firebaseio.com","projectId":"gse-yeatman-lab","storageBucket":"gse-yeatman-lab.appspot.com","messagingSenderId":"984978630424"},"app":{"navbarVariant":"info"},"home":{"shortTitle":"ROAR","title":"Rapid Online Assessment of Reading","tagline":"Are the words real or fake?","backgroundUrl":"https://github.com/jyeatman/SwipesForScience/blob/master/src/assets/Cover-WordDetective-scaled.png?raw=true"},"play":{"blankImage":"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_blank_canvas.svg?sanitize=true"},"chats":{"blankImage":"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_no_data.svg?sanitize=true"},"profile":{"blankImage":"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_chatting.svg?sanitize=true"},"tutorial":{"customBackgroundAnimation":"","steps":{"intro":[{"text":"WELCOME TO THE WORD ADVENTURE!","image":"https://raw.githubusercontent.com/richford/fibr/master/src/assets/undraw_children_4rtb.svg?sanitize=true"},{"text":"WELCOME TO THE WORD ADVENTURE!<br>Swipe RIGHT for REAL WORDS.<br>Swipe LEFT for FAKE WORDS","image":"https://raw.githubusercontent.com/jyeatman/SwipesForScience/master/src/assets/Instrructions.jpg"}],"examples":[{"text":"SUN is a real word. So swipe RIGHT.","pointer":"A-sun","answer":1,"tutorialStep":0},{"text":"BULBET is not a real word. So swipe LEFT.","pointer":"A-bulbet","answer":-1,"tutorialStep":1},{"text":"INSIDE is a real word. So swipe RIGHT.","pointer":"A-inside","answer":1,"tutorialStep":0},{"text":"BLEDGE is a fake word. So swipe LEFT.","pointer":"A-bledge","answer":-1,"tutorialStep":1},{"text":"Are you ready to play?<br>You can always return to the tutorial. You can leave any time you like and we\'ll save your progress.","tutorialCompleted":true}]}}}')},8453:function(e,t,i){},"84ac":function(e,t,i){},"85ec":function(e,t,i){},"89f6":function(e,t,i){},"95a6":function(e,t,i){e.exports=i.p+"img/kesh-profile-icon.13d37edb.svg"},"98e0":function(e,t,i){},"9bad":function(e,t,i){"use strict";var s=i("4f41"),r=i.n(s);r.a},"9f9f":function(e,t,i){},b81c:function(e,t,i){e.exports=i.p+"img/swipes-for-science-logo.279e7d6c.svg"},b8ab:function(e,t,i){"use strict";var s=i("98e0"),r=i.n(s);r.a},b946:function(e,t,i){},bf99:function(e,t,i){},c061:function(e,t,i){"use strict";var s=i("4906"),r=i.n(s);r.a},c504:function(e,t,i){},c638:function(e,t,i){},d80c:function(e,t,i){},dd79:function(e,t,i){"use strict";var s=i("c638"),r=i.n(s);r.a},ea06:function(e,t,i){e.exports=function(){return new Worker(i.p+"af40ddaae728279d72b6.worker.js")}},efb1:function(e,t,i){},f3a5:function(e,t,i){"use strict";var s=i("b946"),r=i.n(s);r.a},f8e9:function(e,t,i){},f9fb:function(e,t,i){"use strict";var s=i("bf99"),r=i.n(s);r.a},faf5:function(e,t,i){}});
//# sourceMappingURL=app.79a22809.js.map